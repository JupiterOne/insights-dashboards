{
	"widgets": [
		{
			"id": "81eef08b-b102-4407-a31f-71af759a236a",
			"title": "GCP-managed service account keys",
			"type": "number",
			"config": {
				"queries": [
					{
						"name": "query 1",
						"query": "find google_iam_service_account_key with type=\"SYSTEM_MANAGED\" as u\nreturn count(u) as value"
					}
				],
				"settings": {
					"number": {
						"success": {
							"limitCondition": "greaterThanOrEqualTo",
							"val1": 0
						}
					}
				}
			}
		},
		{
			"id": "3cc320d6-a75f-43f5-8d50-51e916c2b8e4",
			"title": "User-managed  service account keys",
			"type": "number",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "find google_iam_service_account_key with type!=\"SYSTEM_MANAGED\" as u\nreturn count(u) as value"
					}
				],
				"settings": {
					"number": {
						"error": {
							"limitCondition": "greaterThan",
							"val1": 0
						}
					}
				}
			}
		},
		{
			"id": "432d53e9-e8cc-4ecb-b3f6-ee302d8a1696",
			"title": "User-managed  service account keys",
			"type": "table",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "find google_iam_service_account_key with type!=\"SYSTEM_MANAGED\" as key\nreturn key._type, key.type, key.displayName, key.createdOn, key.webLink"
					}
				]
			}
		},
		{
			"id": "e0f98e0e-1a38-4035-8e24-a679afbee4f1",
			"title": "Service accounts with Admin privileges",
			"type": "number",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "find google_iam_service_account as user\n  that ASSIGNED google_iam_role\n  with name~=(\n    \"admin\" or\n    \"Admin\"\n  ) or name=(\n    \"roles/owner\" or\n    \"roles/editor\"\n  )\nreturn count(user) as value"
					}
				],
				"settings": {
					"number": {
						"error": {
							"limitCondition": "greaterThan",
							"val1": 0
						}
					}
				}
			}
		},
		{
			"id": "b17fd05c-0465-4083-98b1-0040b5a68e3f",
			"title": "IAM Service Accounts",
			"type": "pie",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "Find google_iam_service_account as u\nreturn u.tag.AccountName AS name, count(u) AS value"
					}
				]
			}
		},
		{
			"id": "2586de92-3bfd-45aa-a4e6-43883dffa57e",
			"title": "Service Accounts with Admin privileges",
			"type": "table",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "find google_iam_service_account as user\n  that ASSIGNED google_iam_role\n  with name~=(\n    \"admin\" or\n    \"Admin\"\n  ) or name=(\n    \"roles/owner\" or\n    \"roles/editor\"\n  )\nreturn\n  user.name,\n  user.username,\n  user.email,\n  google_iam_role.name"
					}
				]
			}
		},
		{
			"id": "284cd905-02ff-4fde-92ba-006682a2e00a",
			"title": "IAM users by Account",
			"type": "pie",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "Find google_user as user\n  return user.tag.AccountName as name, count(user) as value"
					}
				]
			}
		},
		{
			"id": "4cb25be1-076d-4f97-b209-4fa63c079ae9",
			"title": "IAM Roles by Account",
			"type": "pie",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "Find google_iam_role as role\n  return role.tag.AccountName as name, count(role) as value"
					}
				]
			}
		},
		{
			"id": "20e885d1-31bc-401a-9a0d-f6cd18a8e8e8",
			"title": "Service Accounts with Keys older than 90 days",
			"type": "table",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "find google_iam_service_account as serviceAccount\n  that HAS google_iam_service_account_key\n  with createdOn <= date.now-90days\nreturn\n  serviceAccount.id,\n  serviceAccount.email,\n  serviceAccount.description,\n  serviceAccount.enabled,\n  serviceAccount.webLink,\n  google_iam_service_account_key.name,\n  google_iam_service_account_key.type,\n  google_iam_service_account_key.createdOn,\n  google_iam_service_account_key.expiresOn"
					}
				]
			}
		},
		{
			"id": "06d184f3-4f64-44ab-8748-3db3a7bb87f7",
			"title": "Service accounts with write privileges",
			"type": "graph",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "Find google_iam_service_account with tag.AccountName = 'sysdig-development-2' as user\n  that assigned google_iam_binding\n  that uses google_iam_role with readonly!=true\nreturn tree"
					}
				]
			}
		},
		{
			"id": "df62a65d-6e77-4320-ba60-3a3564594d9f",
			"title": "External users with write privileges",
			"type": "graph",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "Find google_user with _source = 'system-mapper'\n  that assigned google_iam_binding with tag.AccountName = 'datadog-dev-335212'\n  that uses google_iam_role with readonly!=true \n  return tree"
					}
				]
			}
		},
		{
			"id": "d6777e2c-189f-4b48-8b82-0a5ce3531988",
			"title": "Service Accounts with Write Privileges",
			"type": "number",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "Find google_iam_service_account as u\nthat assigned google_iam_binding\nthat uses google_iam_role with readonly!=true\nreturn count(u) as value"
					}
				],
				"settings": {
					"number": {
						"error": {
							"limitCondition": "greaterThan",
							"val1": 0
						}
					}
				}
			}
		},
		{
			"id": "6223553a-accd-4981-b1af-fdb49e61aadf",
			"title": "External Users with Write Privileges",
			"type": "number",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "Find google_user with _source = 'system-mapper' as u\n  that assigned google_iam_binding\n  that uses google_iam_role with readonly!=true \nreturn count(u) as value"
					}
				],
				"settings": {
					"number": {
						"error": {
							"limitCondition": "greaterThan",
							"val1": 0
						}
					}
				}
			}
		},
		{
			"id": "e3f23f81-f3b4-4d22-8f2b-942e0b563458",
			"title": "Service Accounts with Keys older than 90 days",
			"type": "number",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "find google_iam_service_account as u\n  that HAS google_iam_service_account_key\n  with createdOn <= date.now-90days\nreturn count(u) as value"
					}
				],
				"settings": {
					"number": {
						"error": {
							"limitCondition": "greaterThan",
							"val1": 0
						}
					}
				}
			}
		},
		{
			"id": "5ee6fa9a-533e-4db5-a1f0-004f85007bbd",
			"title": "Service Account Permissions List",
			"type": "table",
			"config": {
				"queries": [
					{
						"name": "query1",
						"query": "FIND google_iam_service_account WITH email $= \"gserviceaccount.com\" as s\n  (THAT ASSIGNED << AccessPolicy)?\n  (THAT USES AccessRole)?\n  THAT ASSIGNED << AccessPolicy AS p\n  THAT ALLOWS >> *\nRETURN s.email, p.name, p.permissions, p.organization, p.folders, p.project"
					}
				]
			}
		}
	],
	"layouts": {
		"sm": [],
		"xs": [],
		"lg": [
			{
				"w": 2,
				"h": 2,
				"x": 0,
				"y": 2,
				"i": "81eef08b-b102-4407-a31f-71af759a236a",
				"moved": false,
				"static": false
			},
			{
				"w": 2,
				"h": 2,
				"x": 2,
				"y": 2,
				"i": "3cc320d6-a75f-43f5-8d50-51e916c2b8e4",
				"moved": false,
				"static": false
			},
			{
				"w": 8,
				"h": 2,
				"x": 4,
				"y": 2,
				"i": "432d53e9-e8cc-4ecb-b3f6-ee302d8a1696",
				"moved": false,
				"static": false
			},
			{
				"w": 4,
				"h": 2,
				"x": 0,
				"y": 4,
				"i": "e0f98e0e-1a38-4035-8e24-a679afbee4f1",
				"moved": false,
				"static": false
			},
			{
				"w": 4,
				"h": 2,
				"x": 8,
				"y": 0,
				"i": "b17fd05c-0465-4083-98b1-0040b5a68e3f",
				"moved": false,
				"static": false
			},
			{
				"w": 8,
				"h": 2,
				"x": 4,
				"y": 4,
				"i": "2586de92-3bfd-45aa-a4e6-43883dffa57e",
				"moved": false,
				"static": false
			},
			{
				"w": 4,
				"h": 2,
				"x": 0,
				"y": 0,
				"i": "284cd905-02ff-4fde-92ba-006682a2e00a",
				"moved": false,
				"static": false
			},
			{
				"w": 4,
				"h": 2,
				"x": 4,
				"y": 0,
				"i": "4cb25be1-076d-4f97-b209-4fa63c079ae9",
				"moved": false,
				"static": false
			},
			{
				"w": 12,
				"h": 2,
				"x": 0,
				"y": 10,
				"i": "20e885d1-31bc-401a-9a0d-f6cd18a8e8e8",
				"moved": false,
				"static": false
			},
			{
				"w": 6,
				"h": 4,
				"x": 6,
				"y": 6,
				"i": "06d184f3-4f64-44ab-8748-3db3a7bb87f7",
				"moved": false,
				"static": false
			},
			{
				"w": 6,
				"h": 4,
				"x": 0,
				"y": 6,
				"i": "df62a65d-6e77-4320-ba60-3a3564594d9f",
				"moved": false,
				"static": false
			},
			{
				"w": 12,
				"h": 2,
				"x": 0,
				"y": 12,
				"i": "d6777e2c-189f-4b48-8b82-0a5ce3531988",
				"moved": false,
				"static": false
			},
			{
				"w": 12,
				"h": 2,
				"x": 0,
				"y": 14,
				"i": "6223553a-accd-4981-b1af-fdb49e61aadf",
				"moved": false,
				"static": false
			},
			{
				"w": 12,
				"h": 2,
				"x": 0,
				"y": 16,
				"i": "e3f23f81-f3b4-4d22-8f2b-942e0b563458",
				"moved": false,
				"static": false
			},
			{
				"w": 12,
				"h": 2,
				"x": 0,
				"y": 18,
				"i": "5ee6fa9a-533e-4db5-a1f0-004f85007bbd",
				"moved": false,
				"static": false
			}
		],
		"xl": [],
		"md": []
	}
}